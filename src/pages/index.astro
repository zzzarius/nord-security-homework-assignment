---
import Layout from "@/layouts/Layout.astro";
import { ServersList } from "@/components/ServersList";
import { getServers } from "@/api/getServers";
import { Heading1 } from "@/shared/Heading1";
import { Description } from "@/shared/Description";

export const prerender = false;

const token = Astro.cookies.get("token")?.value;

if (!token) {
  return Astro.redirect("/login");
}
let servers = [];
try {
  servers = await getServers(token);
} catch (error) {
  return Astro.redirect("/login");
}
---

<Layout class="flex flex-col items-center px-4" showHeader={true}>
  <Heading1 size="large" className="mb-4">Server list</Heading1>
  <Description className="px-2 mb-7.5 text-nexos-text">
    The distance between you and the server
  </Description>
  <ServersList servers={servers} client:load />
</Layout>
